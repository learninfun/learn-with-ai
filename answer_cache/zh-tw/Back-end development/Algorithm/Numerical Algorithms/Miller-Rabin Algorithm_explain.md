

Miller-Rabin Algorithm是一種概率性質質數測試法，用於檢測一個數字是否為質數。它基於Fermat's Little Theorem和二次剩餘的性質，在確定一個數字是否為質數時，比起其他傳統的質數測試算法，如暴力測試法或埃拉托色尼質數篩法，更加高效。

Miller-Rabin Algorithm的演算法流程如下：

1. 將欲判斷的數字n-1表示成 2^s * d 的形式，其中d為奇數。
2. 隨機選擇一個小於n的整數a作為底數。
3. 計算a^d mod n，若 a^d ≡ 1 (mod n) 或 a^(2^r * d) ≡ -1 (mod n) 就判定這是質數或可能是錯誤的。其中r∈[0,s-1]
4. 如果驗證不是質數，則繼續對a重新選擇底數，重複步驟2-3，若經過k次驗證皆為質數或可能是錯誤的，就判定n為質數；若經過k次驗證存在不合法的結果，就判定n為合數。

以下是一個Miller-Rabin Algorithm的例子：

我們想要確認60是否為質數。

1. 60-1可以表示成 2^2 * 15的形式。
2. 選擇一個隨機底數a = 2。
3. 計算2^15 mod 60，得到32。
4. 因為2^30 ≡ 1 (mod 60)，所以我們可以進行以下的判斷式：

  2^2 * 15 = 60-1
  2^15 ≡ 32 (mod 60)
  2^30 ≡ 1 (mod 60)
  
  因此，2^60 ≡ (2^30)^2 ≡ 1 (mod 60)，所以60可能是錯誤的質數，我們需要繼續進行驗證。
  
5. 我們再次選擇底數a = 7。
6. 計算7^15 mod 60，得到49。
7. 我們也可以進行以下的判斷式：

  7^2 ≡ 49 ≡ -11 (mod 60)
  7^4 ≡ (-11)^2 ≡ 121 ≡ 1 (mod 60)
  
  因此，7^15 ≡ (7^4) * (7^4) * 7^2 ≡ 1 (mod 60)，所以60可能是錯誤的質數，我們需要再次繼續驗證。
  
8. 我們再次選擇底數a = 11。
9. 計算11^15 mod 60，得到49。
10. 進行以下判斷：

  11^2 ≡ 1 (mod 60)
  11^4 ≡ 1 (mod 60)
  
  因此，11^15 ≡ (11^4) * (11^4) * 11^2 ≡ 1 (mod 60)，所以我們可以確定60是錯誤的合數。

因此，我們可以確定60是錯誤的合數，不是質數。 如此反覆執行，直到分別執行了k次測試都沒有成功，我們才能夠大致得到一個數字是否是質數。