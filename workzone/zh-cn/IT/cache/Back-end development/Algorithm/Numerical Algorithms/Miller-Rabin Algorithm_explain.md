

Miller-Rabin Algorithm是一种概率性质质数测试法，用于检测一个数字是否为质数。它基于Fermat's Little Theorem和二次剩余的性质，在确定一个数字是否为质数时，比起其他传统的质数测试算法，如暴力测试法或埃拉托色尼质数筛法，更加高效。

Miller-Rabin Algorithm的演算法流程如下：

1. 将欲判断的数字n-1表示成 2^s * d 的形式，其中d为奇数。
2. 随机选择一个小于n的整数a作为底数。
3. 计算a^d mod n，若 a^d ≡ 1 (mod n) 或 a^(2^r * d) ≡ -1 (mod n) 就判定这是质数或可能是错误的。其中r∈[0,s-1]
4. 如果验证不是质数，则继续对a重新选择底数，重复步骤2-3，若经过k次验证皆为质数或可能是错误的，就判定n为质数；若经过k次验证存在不合法的结果，就判定n为合数。

以下是一个Miller-Rabin Algorithm的例子：

我们想要确认60是否为质数。

1. 60-1可以表示成 2^2 * 15的形式。
2. 选择一个随机底数a = 2。
3. 计算2^15 mod 60，得到32。
4. 因为2^30 ≡ 1 (mod 60)，所以我们可以进行以下的判断式：

  2^2 * 15 = 60-1
  2^15 ≡ 32 (mod 60)
  2^30 ≡ 1 (mod 60)
  
  因此，2^60 ≡ (2^30)^2 ≡ 1 (mod 60)，所以60可能是错误的质数，我们需要继续进行验证。
  
5. 我们再次选择底数a = 7。
6. 计算7^15 mod 60，得到49。
7. 我们也可以进行以下的判断式：

  7^2 ≡ 49 ≡ -11 (mod 60)
  7^4 ≡ (-11)^2 ≡ 121 ≡ 1 (mod 60)
  
  因此，7^15 ≡ (7^4) * (7^4) * 7^2 ≡ 1 (mod 60)，所以60可能是错误的质数，我们需要再次继续验证。
  
8. 我们再次选择底数a = 11。
9. 计算11^15 mod 60，得到49。
10. 进行以下判断：

  11^2 ≡ 1 (mod 60)
  11^4 ≡ 1 (mod 60)
  
  因此，11^15 ≡ (11^4) * (11^4) * 11^2 ≡ 1 (mod 60)，所以我们可以确定60是错误的合数。

因此，我们可以确定60是错误的合数，不是质数。 如此反覆执行，直到分别执行了k次测试都没有成功，我们才能够大致得到一个数字是否是质数。